<%
    # If salesforce isn't configured, do our regular text
    unless Rails.application.secrets.salesforce_username
%>
Welcome to Beyond Z, <%= @user.first_name %>! We are excited to connect with you. Please confirm your email address to activate your account by clicking the link below:

<p><%= link_to 'Confirm your account', confirmation_url(@resource, confirmation_token: @token) %></p>

<p>Thank you,<br />
The Beyond Z Team</p>
<% 
    # but if it is, we'll pull from there
    else
# The purpose here is to pull a Salesforce template and do the variable replacements
# for us.

require 'salesforce'
sf = BeyondZ::Salesforce.new
%><%= sf.get_welcome_email_html.
  sub('{!Contact.FirstName}', @user.first_name).
  sub('{!Contact.LastName}', @user.last_name).
  sub('{!Contact.ConfirmationURL}', confirmation_url(@resource, confirmation_token: @token)).html_safe
%><% end %>
